library(dplyr)
library(dplyr)
library(tabulizer)
extract(url)
extract_areas(url)
extract_tables(url, pages = 134)
url <- "https://www.msd.govt.nz/documents/about-msd-and-our-work/publications-resources/monitoring/household-income-report/2017/2017-incomes-report-wed-19-july-2017.pdf"
extract_areas(url)
extract_tables(url, pages = 134)
ahc60 <- data.frame(extract_tables(url, pages = 134)[[1]])
ahc60
ahc60[1,]
colnames(ahc60) <- c("year", ahc60[1,][2:7])
ahc60
c("year", ahc60[1,][2:7])
colnames(ahc60) <- c("year", as.character(ahc60[1,][2:7]))
ahc60
ahc60 <- data.frame(extract_tables(url, pages = 134)[[1]])
as.character(ahc60[1,][2:7])
ahc60[1,][2:7]
as.character(ahc60[1,][2:7])
as.character(ahc60[1,])[2:7]
ahc60 <- data.frame(extract_tables(url, pages = 134)[[1]], stringsAsFactors = FALSE)
c("year", ahc60[1,][2:7])
colnames(ahc60) <- c("year", ahc60[1,][2:7])
ahc60
ahc60 <- data.frame(extract_tables(url, pages = 134)[[1]], stringsAsFactors = FALSE)
colnames(ahc60) <- c("year", ahc60[1,][2:6], "total")
ahc60 <- ahc60[2:length(ahc60),]
ahc60
ahc60 <- data.frame(extract_tables(url, pages = 134)[[1]], stringsAsFactors = FALSE)
colnames(ahc60) <- c("year", ahc60[1,][2:6], "total")
ahc60 <- ahc60[2:length(ahc60$year),]
ahc60
full_join(ahc60, data.frame(year=1982:2016), by="year")
ahc60 <- ahc60[2:length(ahc60$year),] %>%
mutate_each(as.numeric)
ahc60 <- data.frame(extract_tables(url, pages = 134)[[1]], stringsAsFactors = FALSE)
colnames(ahc60) <- c("year", ahc60[1,][2:6], "total")
mutate_each()
?mutate_each
ahc60[2:length(ahc60$year),] %>%
mutate_each(funs = as.numeric)
ahc60[2:length(ahc60$year),] %>%
mutate_each(funs(as.numeric))
ahc60 <- ahc60[2:length(ahc60$year),] %>%
mutate_each(funs(as.numeric))
ahc60[2:length(ahc60$year),] %>%
mutate_each(funs(as.numeric))
ahc60 <- ahc60[2:length(ahc60$year),] %>%
mutate_each(funs(as.numeric))
ahc60 <- ahc60[2:length(ahc60$year),] %>%
mutate_all(funs(as.numeric))
full_join(ahc60, data.frame(year=1982:2016), by="year")
ahc60
full_join(ahc60, data.frame(year=1986:2016), by="year")
full_join(ahc60, data.frame(year=1986:2016), by="year") %>% arrange(year)
pop <- read.csv("populationEstimates.csv")
pop
?read.csv
default.stringsAsFactors()
pop$X2001
is.numeric(pop$X2001)
read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:12)
library(tidyr)
read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:12)
read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14)
read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = substr(year, 2, 5))
read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = substr(year, 2, 5))
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = substr(year, 2, 5))
pop
colnames(ahc60)
newAgeLevels <- colnames(ahc60)
# Get names from poverty data then match them up with age groups in pop data
ageLevels <- colnames(ahc60)
c(ageLevels["total"])
ageLevels["total"]
c(ageLevels[7])
c(total, rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs")
c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs")
pop$year
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = factor(substr(year, 2, 5)))
rep(
c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
length(levels(pop$year))
)
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
length(levels(pop$year))
)
)
pop$age
c(pop$age, c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"))
data.frame(pop$age, c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"))
length(levels(pop$year)
length(levels(pop$year))
length(levels(pop$year))
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
12#length(levels(pop$year))
)
)
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 4), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
11#length(levels(pop$year))
)
)
pop
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 1), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
length(levels(pop$year))
)
)
pop
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c("total", rep("0-17 yrs", 4), rep("18-24 yrs", 1), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
length(levels(pop$year))
)
) %>%
group_by(year, povAgeGrps) %>%
summarise(count = sum(count))
pop
read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14)
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
filter(age != total) %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c(rep("0-17 yrs", 4), rep("18-24 yrs", 1), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
length(levels(pop$year))
)
) %>%
group_by(year, povAgeGrps) %>%
summarise(count = sum(count))
read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
filter(age != total) %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c(rep("0-17 yrs", 4), rep("18-24 yrs", 1), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
length(levels(pop$year))
)
)
### Bring in population data ###
pop <- read.csv("populationEstimates.csv") %>%
gather("year", "count", 2:14) %>%
filter(age != "total") %>%
mutate(year = factor(substr(year, 2, 5)),
povAgeGrps = rep(
c(rep("0-17 yrs", 4), rep("18-24 yrs", 1), rep("25-44 yrs", 4), rep("45-64 yrs", 4), "65+ yrs"),
length(levels(pop$year))
)
) %>%
group_by(year, povAgeGrps) %>%
summarise(count = sum(count))
pop
